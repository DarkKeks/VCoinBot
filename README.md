# VkCoin bot

Бот для ивента VkCoin

## До конца игры

Последняя версия работавшая до конца игры: [#before-end](https://github.com/DarkKeks/VCoinBot/tree/before-end)

Бот логинится в аккаунты, покупает апгрейды по эвристической стратегии, нажимает на кнопку с некоторой случайной задержкой

Покупка апгрейдов происходит только до достижения порога дохода (25000к/с)

После некоторого порога коины переводятся с аккунта на "основной", называемый в коде `sink`

Так же, до достижения порога основной аккаунт может переводить некоторое кол-во коинов для покупки апгрейдов

У бота есть http апи для автоматизации переводов коинов:
- `/{token}/status` возвращает статус бота содержащий суммарное кол-во коинов, суммарный доход и подробную информацию по каждому из аккунтов
- `/{token}/transfer?to={}&amout={}` Переводит `amount` коинов пользователю с id `to`
- `/{token}/sink?threshold={}&leave={}` Переводит коины с других аккаунтов на основной, если их кол-во превышает `threshold`, оставляя на аккунте `leave`

`{token}` задается переменной окружения `BOT_TOKEN`

## После конца игры
   
После конца игры бот продолжал использоваться для переводов коинов и хранения коинов на нескольких аккаунтах

### Сценарий Sink

Аналогичен тому как работал бот до конца фарма, за исключением покупки апгрейдов и автоматических переводов (т.к. кол-во коинов не увеличивается само по себе)

### Сценарий Stock

Позволяет принимать переводы коинов от людей, сохраняя их в базу данных (подключение задается переменными окружения `DATABASE_URL`, `DATABASE_USERNAME`, `DATABASE_PASSWORD`)

Аккаунт `stock` при получении перевода сохраняет его в базу и переводит коины в `sink` 

## Merchant Api

Через несколько дней после закрытия фарма в игру было добавлено апи для получаения переводов и осуществления переводов, потому бот больше не использовался  

## Формат файла со списком аккаунтов
   
Файл `urls.txt` содержит список url игры, генерируемых скриптом `auth.py`, например
```
https://coin-without-bugs.vkforms.ru/index.html?vk_access_token_settings=friends&vk_app_id=6915965&vk_are_notifications_enabled=0&vk_group_id=137565779&vk_is_app_user=1&vk_language=ru&vk_platform=mobile_android&vk_user_id=159179937&vk_viewer_group_role=member&sign=XXXXXXXXXXX-q1fPPKKO9BiZZmgcoUUh86fUB2giF-g
```
